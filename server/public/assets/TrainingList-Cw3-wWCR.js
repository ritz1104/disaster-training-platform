import{r as m,j as e,N as b,L as u,C as j,M as y,U as v,i as N}from"./index-WRKZqFJu.js";import{f as w}from"./formatters-C68TFZxE.js";import{u as C}from"./useQuery-CmTz_4hp.js";import{F as S}from"./filter-ZLSpwVwM.js";import{S as L}from"./search-DV5nN8pN.js";import{f as P}from"./index-PcI1xVBZ.js";import"./utils-D1gLOp5h.js";const T=async({theme:t,institution:r,status:i,page:o=1})=>{const a=new URLSearchParams;t&&a.append("theme",t),r&&a.append("institution",r),i&&a.append("status",i),a.append("page",o),a.append("limit","12");const d="https://ndma-training-server.onrender.com/api",{data:c}=await N.get(`${d}/trainings?${a}`);return c.data},U=()=>{const[t,r]=m.useState({theme:"",institution:"",status:"",search:""}),[i,o]=m.useState(1),{data:a,isLoading:d,error:c}=C({queryKey:["trainings",t.theme,t.institution,t.status,i],queryFn:()=>T({...t,page:i}),keepPreviousData:!0,retry:1,staleTime:2*60*1e3}),x=["Flood Management","Earthquake Safety","Cyclone Management","Fire Safety","Landslide Prevention","Drought Management","Tsunami Preparedness","Medical Emergency","Search and Rescue","Community Awareness"],p=["Scheduled","Ongoing","Completed","Cancelled"],l=(s,g)=>{r(f=>({...f,[s]:g})),o(1)},h=s=>{switch(s){case"Scheduled":return"bg-blue-100 text-blue-800";case"Ongoing":return"bg-green-100 text-green-800";case"Completed":return"bg-gray-100 text-gray-800";case"Cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},n=a==null?void 0:a.filter(s=>!t.search||s.title.toLowerCase().includes(t.search.toLowerCase())||s.institution.toLowerCase().includes(t.search.toLowerCase()));return c?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-red-600 mb-4",children:"Error loading trainings"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Try Again"})]}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(b,{size:"md",showText:!1}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"NDMA Training Programs"}),e.jsx("p",{className:"text-gray-600",children:"Discover and join disaster preparedness training programs nationwide"})]})]}),e.jsx("div",{className:"mt-4 md:mt-0",children:e.jsx(u,{to:"/create-training",className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Create Training"})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(S,{className:"mr-2",size:20}),e.jsx("h3",{className:"text-lg font-semibold",children:"Filters"})]}),e.jsxs("div",{className:"grid md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(L,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",placeholder:"Search trainings...",value:t.search,onChange:s=>l("search",s.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("select",{value:t.theme,onChange:s=>l("theme",s.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Themes"}),x.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsx("input",{type:"text",placeholder:"Institution",value:t.institution,onChange:s=>l("institution",s.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsxs("select",{value:t.status,onChange:s=>l("status",s.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Status"}),p.map(s=>e.jsx("option",{value:s,children:s},s))]})]})]}),d&&e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}),n&&Array.isArray(n)&&e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.filter(s=>s&&s._id).map(s=>e.jsx("div",{className:"bg-white rounded-lg shadow-lg hover:shadow-xl transition-shadow overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800 line-clamp-2",children:s.title}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${h(s.status)}`,children:s.status})]}),e.jsx("p",{className:"text-gray-600 mb-4 line-clamp-3",children:s.description}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(j,{className:"mr-2",size:16}),P(new Date(s.date),"PPP")]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(y,{className:"mr-2",size:16}),s.location.name||s.location.address]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(v,{className:"mr-2",size:16}),w(s.participants)," participants"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-blue-600 bg-blue-100 px-2 py-1 rounded",children:s.theme}),e.jsx(u,{to:`/trainings/${s._id}`,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"View Details"})]})]})},s._id))}),n&&n.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-gray-500 mb-4",children:"No trainings found matching your criteria"}),e.jsx("button",{onClick:()=>r({theme:"",institution:"",status:"",search:""}),className:"text-blue-600 hover:text-blue-700",children:"Clear filters"})]})]})};export{U as default};
